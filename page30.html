<!DOCTYPE html>
<html>
<body>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Let 's get Creative</title>
    <link rel='stylesheet' type='text/css' media='screen' href='styles.css'>
    <title>Javascript</title> 
        
</head>
    
<body>
    
    <style>
@import url('https://fonts.googleapis.com/css2?family=Brygada+1918:ital@1&family=Sofia&display=swap');
</style>

<script>
    
 canvas#poster-canvas(width='960' height='1280')
function initCanvas() {
  canvasCtx = document.getElementById("poster-canvas").getContext('2d');
}
    
    img.poster-background(src='images/Background.jpg')
    
   $('img.poster-background').on('load', function () {
  var backgroundImg = $('img.poster-background')[0];
  canvasCtx.drawImage(backgroundImg, 0, 0, 960, 1280);
  renderName();
});
    
    function renderText() {
  var text = $('input[text="chText"]').val();
  var fontSize;
  if (text.length < 3) {
    fontSize = 100;
  } else {
    fontSize = parseInt(320 / text.length);
  }
  canvasCtx.font = "bold " + fontSize + "px https://fonts.googleapis.com/css2?family=Brygada+1918:ital@1&family=Sofia&display=swap";
  canvasCtx.fillStyle = "#de071b";
  canvasCtx.fillText(text);
        
       a.upload-btn 
  input#photo(type='file' name='photo' accept='image/jpeg, image/png')
  | Upload your own photos to generate exclusive posters
.upload-btn input {
  position: absolute;
  left: 0;
  top: 0;
  opacity: 0;
  width: 100%;
  height: 68px;
  cursor: pointer;
}
        
 $('#photo').on('change', function (e) {
  var file = e.target.files[0];
  var type = file.type;
  if (type !== 'image/jpeg' && type !== 'image/png') {
    window.toastr.error('Please upload jpg or png Pictures in format');
  } else {
    var formData = new FormData();
    formData.append('avatar', file);
    $.ajax({
      type: 'POST',
      url: '/upload_url',
      data: formData,
      contentType: false,
      processData: false,
      success: function(result) {
        var avatarUrl = result.data.url;
        $('img.avatar').attr('src', avatarUrl);
      },
      error: function(err) {
        
      }
    });
  }
});
        $('img.avatar').on('load', function () {
  var avatarImg = $('img.avatar')[0];
  var originWidth = avatarImg.width;
  var originHeight = avatarImg.height;
  var newWidth, cutStartX, cutStartY;

  if (originWidth < originHeight) {
    newWidth = originWidth;
    cutStartX = 0;
    cutStartY = (originHeight - originWidth) / 2;
  } else if (originWidth > originHeight) {
    newWidth = originHeight;
    cutStartX = (originWidth - originHeight) / 2;
    cutStartY = 0;
  } else {
    newWidth = originWidth;
    cutStartX = 0;
    cutStartY = 0;
  }
  
  canvasCtx.drawImage(avatarImg, cutStartX, cutStartY, newWidth, newWidth, 0, 0, 960, 960);

  uploadPoster();
      
});
        canvasCtx.drawImage(backgroundImg, 0, 0, 960, 1280);

canvasCtx.drawImage(avatarImg, cutStartX, cutStartY, newWidth, newWidth, 0, 0, 960, 960);
        
       document.getElementById("poster-canvas").toBlob(function (blob) {});
        
        
</body>
</html>

